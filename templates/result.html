<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì‹¤í—˜ì ê²°ê³¼ ì •ë³´</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #aaa; padding: 8px; text-align: center; }
        button { padding: 5px 10px; margin: 5px; }
        pre { white-space: pre-wrap; word-break: keep-all; background: #f9f9f9; padding: 10px; }
    </style>
</head>
<body>

    <h2>ğŸ“… ì‹¤í—˜ ì¼ì •ë³„ ê·¸ë£¹ ìš”ì•½</h2>
    <ul>
      {% for group in group_summaries %}
        <li><strong>{{ group.label }}:</strong> {{ group.a }} ~ {{ group.b }} ({{ group.count }}ëª…)</li>
      {% endfor %}
    </ul>
    <hr>

    <h2>ì‹¤í—˜ìë³„ ë‚ ì§œ ë° ì „í™”ë²ˆí˜¸ ê·¸ë£¹</h2>
    {% for label, group in grouped_results.items() %}
        <h3>{{ label }}: {{ group.a }} ~ {{ group.b }}</h3>
        <button onclick="copyToClipboard('{{ group.all_phones|join(',') }}')">ì „í™”ë²ˆí˜¸ ë³µì‚¬</button>
        <button onclick="copyText(`{{ make_sms(group.a, group.b)|replace('`', '\\`') }}`)">ë¬¸ì ë‚´ìš© ë³µì‚¬</button>

        <table>
            <thead>
                <tr>
                    <th>user_id</th>
                    <th>a (ë¡œê·¸ ë‹¤ìŒë‚ )</th>
                    <th>b (a + 28ì¼)</th>
                    <th>ì „í™”ë²ˆí˜¸</th>
                </tr>
            </thead>
            <tbody>
                {% for row in group.rows %}
                <tr>
                    <td>{{ row.user_id }}</td>
                    <td>{{ row.a }}</td>
                    <td>{{ row.b }}</td>
                    <td>{{ row.phones }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <hr>
    {% endfor %}

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function () {
                alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n" + text);
            });
        }

        function copyText(message) {
            navigator.clipboard.writeText(message).then(function () {
                alert("ë¬¸ì ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
            });
        }
    </script>
</body>
</html>

<style>
    body {
        font-family: sans-serif;
        line-height: 1.6;  /* ë³¸ë¬¸ ì „ì²´ ì¤„ê°„ê²© */
        margin: 20px;
    }
    ul {
        padding-left: 20px;
        margin-bottom: 20px;
    }
    li {
        margin-bottom: 8px;  /* ê·¸ë£¹ ìš”ì•½ ì‚¬ì´ ê°„ê²© */
    }
    h2 {
        margin-top: 30px;
        margin-bottom: 10px;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 30px;
    }
    th, td {
        border: 1px solid #aaa;
        padding: 8px;
        text-align: center;
    }
    button {
        padding: 5px 10px;
        margin: 5px 5px 15px 0;
    }
    pre {
        white-space: pre-wrap;
        word-break: keep-all;
        background: #f9f9f9;
        padding: 10px;
    }
</style>
