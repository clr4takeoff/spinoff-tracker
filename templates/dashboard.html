<!DOCTYPE html>
<html>
<head>
    <title>SPINOFF Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="section">
        <h2>ğŸš¨ Inactive Users (2+ days)</h2>
        {% if inactive_users %}
        <table>
            <tr><th>User</th></tr>
            {% for user in inactive_users %}
            <tr><td>{{ user }}</td></tr>
            {% endfor %}
        </table>
        {% else %}
        <p>No inactive users found.</p>
        {% endif %}
    </div>

    {% macro render_section(title, users, section_id) %}
    <div class="section">
        <h2>
            {{ title }} ({{ users | length }}ëª…)
            <button onclick="copyPhones('{{ section_id }}')">ì „í™”ë²ˆí˜¸ ë³µì‚¬</button>
        </h2>

        {% if users %}
        <div id="{{ section_id }}" style="display: none;">
            {{ users | map(attribute='phone') | join(', ') }}
        </div>
        <table>
            <tr><th>Name</th></tr>
            {% for person in users %}
            <tr><td>{{ person.name }}</td></tr>
            {% endfor %}
        </table>
        {% else %}
        <p>í•´ë‹¹í•˜ëŠ” ì‹¤í—˜ìê°€ ì—†ìŠµë‹ˆë‹¤</p>
        {% endif %}
    </div>
    {% endmacro %}

    {{ render_section("âœ… ì‹¤í—˜ ì§„ì…ì", ready_info.common, "commonPhones") }}
    {{ render_section("ğŸ“‹ ì„¤ë¬¸ ì‘ë‹µë§Œ í•œ ì‚¬ëŒ", ready_info.only_survey, "surveyPhones") }}
    {{ render_section("ğŸ§ª í…ŒìŠ¤íŠ¸ë§Œ í•œ ì‚¬ëŒ", ready_info.only_test, "testPhones") }}
    {{ render_section("ğŸ“® ë©”ì¼ ë°œì†¡ ì™„ë£Œì ì¤‘ ë¯¸ì‘ë‹µì", ready_info.only_application, "appPhones") }}

    <script>
    function copyPhones(id) {
        const phoneText = document.getElementById(id).innerText.trim();
        if (!phoneText) {
            alert("ë³µì‚¬í•  ì „í™”ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }
        navigator.clipboard.writeText(phoneText)
            .then(() => alert("ì „í™”ë²ˆí˜¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"))
            .catch(err => alert("ë³µì‚¬ ì‹¤íŒ¨: " + err));
    }
    </script>

</body>
</html>
